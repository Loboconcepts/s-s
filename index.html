<!DOCTYPE html>
<html>
<head>
	<title>Dinner Party</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style type="text/css">
		body {
			margin:0;
			-webkit-touch-callout: none;
			-webkit-user-select: none; /* Disable selection/copy in UIWebView */
		}
		td {
			border-right:solid 1px #333333;
			padding: 0 10px;

		}
		table {
			border-spacing: 0px;
		}
	</style>
</head>
<body>
	<canvas id="game"></canvas>
	<button onclick="window.clearTimeout(go)">STOP</button>
	<div style="font-size:10px;" id="purpose_actions"></div>
	<script src="js/main.js"></script>
	
	<script type="text/javascript">
		//############# STARTING VARIABLES ################//

		var mansion = new Map (5,4, [0,
			5,0,0,0,2,
			4,0,0,0,1,
			3,0,7,0,2,
			5,0,0,0,1
			]);
		var player = new Player(3.5,2,1,{
			greeting: ["Good", "Bad"],
			introduce: ["REAL NAME", "FAKE NAME"],
			blackout: ["I don't know", "That was suspicious"],

		});
		var camera = new Camera(canvas);
		var controls = new Controls();

		// GUEST:              Neutral guest. Will not murder others.
		// MURDERER:           Neutral guest. Will murder others.
		// CORRUPT:            Neutral guest. Will not murder others.
		// AVENGER:            Neutral guest. Will murder specific guest.
		// OCCULTIST:          Influences guests. Will murder guests.
		// AGENT:              Protects guests. Will murder murderer.
		// SPY:                Influence guests. Will murder undercover agent.
		// VENDOR:             Entertains guests. Can murder based on disposition

		// x,y,direction,texture,persona,logic,suspicion

		var cornelia_cornhowser = new AI(3.3,1,1,new Bitmap('./assets/walking-guy.png',2000,800),{
			full_name: "Cornelia Cornhowser",
			genre: "GUEST",
			conversation: {
				topic : "greeting",
				greeting: ["Hey there friend, how are you?",{
					0: "Great!",
					1: "Sorry to hear that."
				},false],
				introduce : ["My name is Cornelia.", {
					0: "Nice to meet you.",
					1: "Nice to meet you."
				},false],
				blackout : ["What was that?", {
					0: "",
					1: ""
				},false]
			}
			
		},{purpose:"think", act:"stand"},0);

		var dogingo_dogergie = new AI(2.3,1,1,new Bitmap('./assets/walking-guy.png',2000,800),{
			full_name: "Dogingo Dogerie",
			genre: "GUEST",
			conversation: {
				topic : "greeting",
				greeting: ["Wazzup?",{
					0: "Chill!",
					1: "Weaksauce."
				},false],
				introduce : ["Me Nambre is Dogingo, yo.", {
					0: "Nice to meet you.",
					1: "Nice to meet you."
				},false],
				blackout : ["What was that?", {
					0: "",
					1: ""
				},false]
			}
			
		},{purpose:"think", act:"stand"},0);
 
		var fransesca_flamenco = new AI(4.8,1,1,new Bitmap('./assets/walking-guy.png',2000,800),{
			full_name: "Fransesca Flamenco",
			genre: "GUEST",
			conversation: {
				topic : "greeting",
				greeting: ["Howdy partner. How ya doing?",{
						0: "Cool!",
						1: "Bummer."
					},false],
				introduce : ["Hi. I'm Fransesca!", {
						0: "Nice to meet you.",
						1: "Nice to meet you."
					},false],
				blackout : ["What was that?", {
					0: "",
					1: ""
				},false]
			}
			
		},{purpose:"think", act:"stand"},0);

		var sunwell_sunflower = new AI(2.5,1,1,new Bitmap('./assets/walking-guy.png',2000,800),{
			full_name: "Sunwell Sunflower",
			genre: "MURDERER",
			conversation: {
				topic : "greeting",
				greeting: ["How does the rest of your life look?",
					{
						0: "Hmmm.",
						1: "I can help with that."
					},
				false],
				introduce : ["Sunwell. Leave me alone.", 
					{
						0: "Go away.",
						1: "Go away."
					},
				false],
				blackout : ["What do you want?", {
					0: "",
					1: ""
				},false]
			}
		},{purpose:"think", act:"stand"},1);

		var perry_periscope = new AI(4.3,1,1,new Bitmap('./assets/walking-guy.png',2000,800),{
			full_name: "Perry Periscope",
			genre: "AGENT",
			conversation: {
				topic : "greeting",
				greeting: ["Hiya, pal. How's it going?",
					{
						0: "Sweet!",
						1: "Damn shame."
					},
				false],
				introduce : ["The name's Perry.", 
					{
						0: "Nice to meet you.",
						1: "Nice to meet you."
					},
				false],
				blackout : ["What was that?", {
					0: "",
					1: ""
				},false]
			}
		},{purpose:"think", act:"stand"},1);


		var AI_array = [sunwell_sunflower,perry_periscope,cornelia_cornhowser,dogingo_dogergie,fransesca_flamenco];
		var everyone_array = [player,sunwell_sunflower,perry_periscope,cornelia_cornhowser,dogingo_dogergie,fransesca_flamenco];
		// document.getElementById("controls").style.width = window.innerWidth + "px";
		// document.getElementById("controls").style.height = window.innerHeight + "px";
		// init();
		// window.addEventListener("blur",function(ev) {if(gameState == state_EXPLORE)gameState = state_PAUSED}, true);
		// window.addEventListener("focus",function(ev) {if(gameState == state_PAUSED)gameState = state_EXPLORE}, true);


		 function show_characters_logic() {
			var report = [];
			for (var i=0;i<AI_array.length;i++) {
				report.push("<tr><td>"+AI_array[i].persona.full_name+"</td>");
				report.push("<td>"+AI_array[i].logic.purpose+"</td>");
				report.push("<td>"+AI_array[i].logic.act+"</td></tr>");
				
			}
			document.getElementById("purpose_actions").innerHTML = "<table><tr><td><strong>Character</strong></td><td><strong>Purpose</strong></td><td><strong>Action</strong></td></tr>"+report.join(" ")+"</table><br>Time: "+ time.join(" : ");
		}

		function load() {
			camera.ctx.save();
			camera.ctx.fillStyle = "rgba(0,0,0,1)"
			camera.ctx.fillRect(0,0,camera.width,camera.height);
			camera.ctx.restore();
			console.log("loading");
			for (var i =0;i<mansion.texture.length;i++) {
				if (mansion.texture[i].image.complete) counter++;
			}
			if (counter >= mansion.texture.length) {
				init();	
			}
			else {
				counter = 0;
				window.setTimeout(load,500)
			}
		}
		load();
		

	</script>

</body>
</html>